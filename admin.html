<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Underground Vibe ‚Äî Admin Paneli. ƒ∞√ßerik y√∂netimi.">
    <title>Underground Vibe ‚Äî Admin</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <!-- ===== LOGIN EKRANI ===== -->
    <div class="login-container" id="login-screen">
        <div class="login-box">
            <div class="login-title">UNDERGND_ADMIN</div>
            <div class="login-subtitle">Kontrol merkezine giri≈ü yap</div>
            <form id="login-form">
                <div class="form-group">
                    <label class="form-label" for="login-email">E-posta</label>
                    <input class="form-input" type="email" id="login-email" placeholder="admin@example.com" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="login-password">≈ûifre</label>
                    <input class="form-input" type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <button class="btn btn-primary" type="submit" style="width:100%;justify-content:center;margin-top:8px;">
                    Giri≈ü Yap
                </button>
            </form>
        </div>
    </div>

    <!-- ===== ADMIN PANELƒ∞ ===== -->
    <div class="admin-wrapper" id="admin-panel" style="display:none;">
        <div class="container">

            <!-- Header -->
            <div class="admin-header">
                <div>
                    <span class="section-tag">// Kontrol Merkezi</span>
                    <h1 class="section-title">Admin Panel</h1>
                </div>
                <div style="display:flex;gap:12px;align-items:center;">
                    <a href="index.html" class="btn btn-secondary btn-small">‚Üê Siteye D√∂n</a>
                    <button class="btn btn-danger btn-small" onclick="adminLogout()">√áƒ±kƒ±≈ü</button>
                </div>
            </div>

            <!-- Tabs -->
            <div class="admin-tabs" id="admin-tabs">
                <button class="admin-tab active" data-tab="music">üéµ M√ºzik</button>
                <button class="admin-tab" data-tab="images">üì∏ G√∂rseller</button>
                <button class="admin-tab" data-tab="notes">üìù Notlar</button>
            </div>

            <!-- ===== M√úZƒ∞K B√ñL√úM√ú ===== -->
            <div class="admin-section active" id="section-music">
                <div class="card" style="padding:24px;margin-bottom:32px;">
                    <h3 style="font-size:1rem;font-weight:600;margin-bottom:20px;">Yeni M√ºzik Ekle</h3>
                    <form id="music-form">
                        <div class="grid-2">
                            <div class="form-group">
                                <label class="form-label" for="music-title">Ba≈ülƒ±k *</label>
                                <input class="form-input" type="text" id="music-title" placeholder="Par√ßa adƒ±" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="music-genre">T√ºr</label>
                                <input class="form-input" type="text" id="music-genre"
                                    placeholder="Hip-Hop, Trap, Lo-fi...">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="music-bpm">BPM</label>
                            <input class="form-input" type="number" id="music-bpm" placeholder="140">
                        </div>
                        <div class="grid-2">
                            <div class="form-group">
                                <label class="form-label">Kapak G√∂rseli</label>
                                <input class="form-file" type="file" id="music-cover" accept="image/*">
                                <label class="form-file-label" for="music-cover" id="music-cover-label">
                                    üì∑ Kapak G√∂rseli Se√ß
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ses Dosyasƒ± *</label>
                                <input class="form-file" type="file" id="music-audio" accept="audio/*" required>
                                <label class="form-file-label" for="music-audio" id="music-audio-label">
                                    üéµ Ses Dosyasƒ± Se√ß
                                </label>
                            </div>
                        </div>
                        <button class="btn btn-primary" type="submit" id="music-submit">M√ºzik Ekle</button>
                    </form>
                </div>

                <h3 style="font-size:1rem;font-weight:600;margin-bottom:16px;">Mevcut M√ºzikler</h3>
                <div id="music-table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Kapak</th>
                                <th>Ba≈ülƒ±k</th>
                                <th>BPM</th>
                                <th>T√ºr</th>
                                <th>Tarih</th>
                                <th>ƒ∞≈ülem</th>
                            </tr>
                        </thead>
                        <tbody id="music-table-body"></tbody>
                    </table>
                </div>
            </div>

            <!-- ===== G√ñRSEL B√ñL√úM√ú ===== -->
            <div class="admin-section" id="section-images">
                <div class="card" style="padding:24px;margin-bottom:32px;">
                    <h3 style="font-size:1rem;font-weight:600;margin-bottom:20px;">Yeni G√∂rsel Ekle</h3>
                    <form id="image-form">
                        <div class="form-group">
                            <label class="form-label" for="image-title">Ba≈ülƒ±k *</label>
                            <input class="form-input" type="text" id="image-title" placeholder="G√∂rsel ba≈ülƒ±ƒüƒ±"
                                required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="image-desc">A√ßƒ±klama</label>
                            <textarea class="form-textarea" id="image-desc"
                                placeholder="Kƒ±sa bir a√ßƒ±klama..."></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">G√∂rsel Dosyasƒ± *</label>
                            <input class="form-file" type="file" id="image-file" accept="image/*" required>
                            <label class="form-file-label" for="image-file" id="image-file-label">
                                üì∑ G√∂rsel Se√ß
                            </label>
                        </div>
                        <button class="btn btn-primary" type="submit" id="image-submit">G√∂rsel Ekle</button>
                    </form>
                </div>

                <h3 style="font-size:1rem;font-weight:600;margin-bottom:16px;">Mevcut G√∂rseller</h3>
                <div id="images-table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>√ñnizleme</th>
                                <th>Ba≈ülƒ±k</th>
                                <th>A√ßƒ±klama</th>
                                <th>Tarih</th>
                                <th>ƒ∞≈ülem</th>
                            </tr>
                        </thead>
                        <tbody id="images-table-body"></tbody>
                    </table>
                </div>
            </div>

            <!-- ===== NOT B√ñL√úM√ú ===== -->
            <div class="admin-section" id="section-notes">
                <div class="card" style="padding:24px;margin-bottom:32px;">
                    <h3 style="font-size:1rem;font-weight:600;margin-bottom:20px;">Yeni Not Ekle</h3>
                    <form id="note-form">
                        <div class="form-group">
                            <label class="form-label" for="note-title">Ba≈ülƒ±k *</label>
                            <input class="form-input" type="text" id="note-title" placeholder="Not ba≈ülƒ±ƒüƒ±" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="note-content">ƒ∞√ßerik *</label>
                            <textarea class="form-textarea" id="note-content" placeholder="D√º≈ü√ºncelerini yaz..."
                                required style="min-height:200px;"></textarea>
                        </div>
                        <button class="btn btn-primary" type="submit" id="note-submit">Not Ekle</button>
                    </form>
                </div>

                <h3 style="font-size:1rem;font-weight:600;margin-bottom:16px;">Mevcut Notlar</h3>
                <div id="notes-table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Ba≈ülƒ±k</th>
                                <th>ƒ∞√ßerik</th>
                                <th>Tarih</th>
                                <th>ƒ∞≈ülem</th>
                            </tr>
                        </thead>
                        <tbody id="notes-table-body"></tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>

    <!-- ===== TOAST CONTAINER ===== -->
    <div class="toast-container"></div>

    <!-- ===== SCRIPTS ===== -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/config.js"></script>
    <script src="js/app.js"></script>
    <script src="js/admin.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {

            const loginScreen = document.getElementById('login-screen');
            const adminPanel = document.getElementById('admin-panel');

            // Oturum kontrol√º
            const isAuth = await checkAdminAuth();

            if (isAuth) {
                loginScreen.style.display = 'none';
                adminPanel.style.display = 'block';
                initAdminTabs();
                loadAdminMusic();
            }

            // ---- Login Form ----
            document.getElementById('login-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;

                const success = await adminLogin(email, password);
                if (success) {
                    loginScreen.style.display = 'none';
                    adminPanel.style.display = 'block';
                    initAdminTabs();
                    loadAdminMusic();
                }
            });

            // ---- Dosya se√ßim etiketlerini g√ºncelle ----
            function setupFileLabel(inputId, labelId) {
                const input = document.getElementById(inputId);
                const label = document.getElementById(labelId);
                if (input && label) {
                    input.addEventListener('change', () => {
                        if (input.files.length > 0) {
                            label.textContent = '‚úÖ ' + input.files[0].name;
                            label.style.borderColor = 'var(--neon-green)';
                            label.style.color = 'var(--neon-green)';
                        }
                    });
                }
            }

            setupFileLabel('music-cover', 'music-cover-label');
            setupFileLabel('music-audio', 'music-audio-label');
            setupFileLabel('image-file', 'image-file-label');

            // ---- M√ºzik Form ----
            document.getElementById('music-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const submitBtn = document.getElementById('music-submit');
                submitBtn.disabled = true;
                submitBtn.textContent = 'Y√ºkleniyor...';

                await addMusic({
                    title: document.getElementById('music-title').value,
                    genre: document.getElementById('music-genre').value,
                    bpm: document.getElementById('music-bpm').value,
                    coverFile: document.getElementById('music-cover').files[0],
                    audioFile: document.getElementById('music-audio').files[0]
                });

                e.target.reset();
                document.getElementById('music-cover-label').textContent = 'üì∑ Kapak G√∂rseli Se√ß';
                document.getElementById('music-cover-label').style.borderColor = '';
                document.getElementById('music-cover-label').style.color = '';
                document.getElementById('music-audio-label').textContent = 'üéµ Ses Dosyasƒ± Se√ß';
                document.getElementById('music-audio-label').style.borderColor = '';
                document.getElementById('music-audio-label').style.color = '';
                submitBtn.disabled = false;
                submitBtn.textContent = 'M√ºzik Ekle';
            });

            // ---- G√∂rsel Form ----
            document.getElementById('image-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const submitBtn = document.getElementById('image-submit');
                submitBtn.disabled = true;
                submitBtn.textContent = 'Y√ºkleniyor...';

                await addImage({
                    title: document.getElementById('image-title').value,
                    description: document.getElementById('image-desc').value,
                    imageFile: document.getElementById('image-file').files[0]
                });

                e.target.reset();
                document.getElementById('image-file-label').textContent = 'üì∑ G√∂rsel Se√ß';
                document.getElementById('image-file-label').style.borderColor = '';
                document.getElementById('image-file-label').style.color = '';
                submitBtn.disabled = false;
                submitBtn.textContent = 'G√∂rsel Ekle';
            });

            // ---- Not Form ----
            document.getElementById('note-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const submitBtn = document.getElementById('note-submit');
                submitBtn.disabled = true;
                submitBtn.textContent = 'Ekleniyor...';

                await addNote({
                    title: document.getElementById('note-title').value,
                    content: document.getElementById('note-content').value
                });

                e.target.reset();
                submitBtn.disabled = false;
                submitBtn.textContent = 'Not Ekle';
            });

        });
    </script>

</body>

</html>